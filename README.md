# Seal

ä¸€ä¸ªç”¨Rustå®ç°çš„æ•°å­—æ°´å°CLIå·¥å…·ï¼Œæ”¯æŒç»™å›¾ç‰‡ã€éŸ³é¢‘å’Œè§†é¢‘æ–‡ä»¶æ·»åŠ å’Œæå–æ•°å­—æ°´å°ã€‚

## ç‰¹æ€§

- ğŸ–¼ï¸ **å›¾ç‰‡æ°´å°**: æ”¯æŒJPG, PNG, BMP, GIF, TIFF, WebPç­‰æ ¼å¼
- ğŸµ **éŸ³é¢‘æ°´å°**: æ”¯æŒWAVæ ¼å¼
- ğŸ¬ **è§†é¢‘æ°´å°**: æ”¯æŒå¤šç§è§†é¢‘æ ¼å¼ï¼Œå«FFmpegé›†æˆ
- ğŸ”¢ **DCTç®—æ³•**: åŸºäºç¦»æ•£ä½™å¼¦å˜æ¢çš„é«˜æ€§èƒ½æ°´å°ç®—æ³•
- âš¡ **é«˜æ€§èƒ½**: åŸºäºRustå’Œrustdctåº“ï¼Œå®‰å…¨ä¸”é«˜æ•ˆ
- ğŸ¯ **ç²¾ç¡®æ§åˆ¶**: å¯è°ƒèŠ‚æ°´å°å¼ºåº¦
- ğŸ“Š **è¿›åº¦æ˜¾ç¤º**: ç¾è§‚çš„è¿›åº¦æ¡å’ŒçŠ¶æ€æç¤º

## å®‰è£…

### ä»æºç æ„å»º

ç¡®ä¿ä½ å·²ç»å®‰è£…äº†Rustå’ŒCargoï¼Œç„¶åè¿è¡Œï¼š

```bash
git clone <repository-url>
cd media-seal-rs
cargo build --release
```

ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶ä½äº `target/release/seal`

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬è¯­æ³•

```bash
seal <COMMAND> [OPTIONS]
```

### å‘½ä»¤

#### åµŒå…¥æ°´å° (embed)

```bash
seal embed -i <è¾“å…¥æ–‡ä»¶> -o <è¾“å‡ºæ–‡ä»¶> -w <æ°´å°å†…å®¹> [-a <ç®—æ³•>] [-s <å¼ºåº¦>] [--lossless]
```

**å‚æ•°è¯´æ˜:**
- `-i, --input <æ–‡ä»¶>`: è¾“å…¥æ–‡ä»¶è·¯å¾„
- `-o, --output <æ–‡ä»¶>`: è¾“å‡ºæ–‡ä»¶è·¯å¾„  
- `-w, --watermark <æ–‡æœ¬>`: æ°´å°å†…å®¹
- `-a, --algorithm <ç®—æ³•>`: ä½¿ç”¨çš„ç®—æ³• (ç›®å‰ä»…æ”¯æŒdctï¼Œé»˜è®¤: dct)
- `-s, --strength <å¼ºåº¦>`: æ°´å°å¼ºåº¦ 0.0-1.0 (é»˜è®¤: 0.1)
- `--lossless`: æ˜¯å¦ä½¿ç”¨æ— æŸå‹ç¼©ï¼ˆä»…å¯¹è§†é¢‘æœ‰æ•ˆï¼‰
- `-v, --verbose`: è¯¦ç»†è¾“å‡º

**ç¤ºä¾‹:**

```bash
# ç»™å›¾ç‰‡æ·»åŠ æ°´å°
seal embed -i photo.jpg -o photo_watermarked.jpg -w "ç‰ˆæƒæ‰€æœ‰" -s 0.1

# ç»™éŸ³é¢‘æ·»åŠ æ°´å°
seal embed -i audio.wav -o audio_watermarked.wav -w "æˆ‘çš„éŸ³ä¹" -s 0.05

# ç»™è§†é¢‘æ·»åŠ æ°´å°
seal embed -i video.mp4 -o video_watermarked.mp4 -w "ç‰ˆæƒæ‰€æœ‰" -s 0.1

# ç»™è§†é¢‘æ·»åŠ æ— æŸæ°´å°
seal embed -i video.mp4 -o video_watermarked.mp4 -w "ç‰ˆæƒæ‰€æœ‰" --lossless
```

#### æå–æ°´å° (extract)

```bash
seal extract -i <è¾“å…¥æ–‡ä»¶> -l <é•¿åº¦> [-a <ç®—æ³•>] [-o <è¾“å‡ºæ–‡ä»¶>]
```

**å‚æ•°è¯´æ˜:**
- `-i, --input <æ–‡ä»¶>`: åŒ…å«æ°´å°çš„æ–‡ä»¶è·¯å¾„
- `-l, --length <é•¿åº¦>`: æœŸæœ›çš„æ°´å°æ–‡æœ¬é•¿åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰
- `-a, --algorithm <ç®—æ³•>`: ä½¿ç”¨çš„ç®—æ³• (ç›®å‰ä»…æ”¯æŒdctï¼Œé»˜è®¤: dct)
- `-o, --output <æ–‡ä»¶>`: ä¿å­˜æå–æ°´å°çš„æ–‡ä»¶ (å¯é€‰)
- `-v, --verbose`: è¯¦ç»†è¾“å‡º

**ç¤ºä¾‹:**

```bash
# ä»å›¾ç‰‡æå–æ°´å°
seal extract -i photo_watermarked.jpg -l 4

# ä»éŸ³é¢‘æå–æ°´å°å¹¶ä¿å­˜åˆ°æ–‡ä»¶
seal extract -i audio_watermarked.wav -l 6 -o extracted_watermark.txt

# ä»è§†é¢‘æå–æ°´å°
seal extract -i video_watermarked.mp4 -l 4
```

## ç®—æ³•è¯´æ˜

### DCT (ç¦»æ•£ä½™å¼¦å˜æ¢)

- **ä¼˜ç‚¹**: é²æ£’æ€§å¥½ï¼ŒæŠ—å‹ç¼©èƒ½åŠ›å¼ºï¼Œé«˜æ€§èƒ½å®ç°
- **é€‚ç”¨**: éœ€è¦è¾ƒå¼ºæŠ—æ”»å‡»èƒ½åŠ›çš„åœºæ™¯
- **ç‰¹æ€§**: 
  - ä½¿ç”¨`rustdct`åº“ï¼Œæ€§èƒ½ä¼˜å¼‚
  - æ”¯æŒä»»æ„å°ºå¯¸å›¾åƒï¼ˆè‡ªåŠ¨å¡«å……ï¼‰
  - åŸºäº8Ã—8å—å¤„ç†
  - æ”¯æŒå›¾ç‰‡ã€éŸ³é¢‘å’Œè§†é¢‘æ°´å°

## æ”¯æŒæ ¼å¼

### å›¾ç‰‡æ ¼å¼
- JPEG (.jpg, .jpeg)
- PNG (.png)
- BMP (.bmp)
- GIF (.gif)
- TIFF (.tiff)
- WebP (.webp)

### éŸ³é¢‘æ ¼å¼
- WAV (.wav, .wave)

### è§†é¢‘æ ¼å¼
- MP4 (.mp4)
- AVI (.avi)
- MKV (.mkv)
- MOV (.mov)
- å…¶ä»–FFmpegæ”¯æŒçš„æ ¼å¼

## æ³¨æ„äº‹é¡¹

1. **æ°´å°é•¿åº¦**: ç¡®ä¿æ°´å°æ–‡æœ¬é•¿åº¦é€‚ä¸­ï¼Œè¿‡é•¿çš„æ°´å°å¯èƒ½å½±å“åµŒå…¥æ•ˆæœ
2. **å¼ºåº¦è®¾ç½®**: 
   - å¼ºåº¦è¿‡ä½å¯èƒ½å¯¼è‡´æ°´å°æå–å›°éš¾
   - å¼ºåº¦è¿‡é«˜å¯èƒ½å½±å“åª’ä½“è´¨é‡
   - å»ºè®®èŒƒå›´: 0.05-0.2
3. **æ ¼å¼å…¼å®¹**: DCTç®—æ³•æ”¯æŒä»»æ„å°ºå¯¸å›¾åƒï¼ˆè‡ªåŠ¨å¡«å……å¤„ç†ï¼‰
4. **è´¨é‡ä¿æŒ**: åµŒå…¥æ°´å°ä¼šè½»å¾®å½±å“åŸå§‹åª’ä½“è´¨é‡
5. **è§†é¢‘å¤„ç†**: è§†é¢‘æ°´å°ä¼šé€å¸§å¤„ç†ï¼Œå¤„ç†æ—¶é—´è¾ƒé•¿
6. **FFmpegä¾èµ–**: è§†é¢‘åŠŸèƒ½éœ€è¦FFmpegæ”¯æŒï¼Œä¼šè‡ªåŠ¨ä¸‹è½½

## å¼€å‘

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main.rs          # CLIä¸»ç¨‹åº
â”œâ”€â”€ lib.rs           # åº“å…¥å£
â”œâ”€â”€ cli.rs           # å‘½ä»¤è¡Œå‚æ•°å®šä¹‰
â”œâ”€â”€ error.rs         # é”™è¯¯å¤„ç†
â”œâ”€â”€ watermark/       # æ°´å°ç®—æ³•æ¨¡å—
â”‚   â”œâ”€â”€ mod.rs       # ç®—æ³•å·¥å‚
â”‚   â”œâ”€â”€ trait.rs     # é€šç”¨æ¥å£
â”‚   â””â”€â”€ dct.rs       # DCTç®—æ³•å®ç°
â””â”€â”€ media/           # åª’ä½“å¤„ç†æ¨¡å—
    â”œâ”€â”€ mod.rs
    â”œâ”€â”€ image.rs     # å›¾ç‰‡å¤„ç†
    â”œâ”€â”€ audio.rs     # éŸ³é¢‘å¤„ç†
    â””â”€â”€ video.rs     # è§†é¢‘å¤„ç†
```

### ä½œä¸ºåº“ä½¿ç”¨

```rust
use seal::prelude::*;

fn main() -> Result<()> {
    // åˆ›å»ºDCTç®—æ³•
    let algorithm = WatermarkFactory::create_algorithm(Algorithm::Dct);
    
    // åµŒå…¥å›¾ç‰‡æ°´å°
    ImageWatermarker::embed_watermark(
        "input.jpg",
        "output.jpg",
        "æˆ‘çš„æ°´å°",
        algorithm.as_ref(),
        0.1
    )?;
    
    // æå–å›¾ç‰‡æ°´å°
    let watermark = ImageWatermarker::extract_watermark(
        "output.jpg",
        algorithm.as_ref(),
        4 // æ°´å°å­—ç¬¦æ•°
    )?;
    
    println!("æå–çš„æ°´å°: {}", watermark);
    Ok(())
}
```

### è¿è¡Œæµ‹è¯•

```bash
cargo test
```

### æ€§èƒ½æµ‹è¯•

```bash
cargo bench
```

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## è®¸å¯

[MIT License](LICENSE)

## æ›´æ–°æ—¥å¿—

### v0.1.0 - åˆå§‹ç‰ˆæœ¬
- âœ… å®ç°DCTæ•°å­—æ°´å°ç®—æ³•
- âœ… æ”¯æŒå›¾ç‰‡æ°´å°ï¼ˆJPG, PNG, BMP, GIF, TIFF, WebPï¼‰
- âœ… æ”¯æŒéŸ³é¢‘æ°´å°ï¼ˆWAVæ ¼å¼ï¼‰
- âœ… æ”¯æŒè§†é¢‘æ°´å°ï¼ˆå¤šç§æ ¼å¼ï¼Œå«FFmpegé›†æˆï¼‰
- âœ… ä½¿ç”¨rustdctåº“ï¼Œé«˜æ€§èƒ½å®ç°
- âœ… ç¾è§‚çš„è¿›åº¦æ¡å’ŒçŠ¶æ€æç¤º
- âœ… æ”¯æŒæ— æŸè§†é¢‘å‹ç¼©é€‰é¡¹
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·ä½“éªŒ

## ä¾èµ–åº“

- `clap` - å‘½ä»¤è¡Œå‚æ•°è§£æ
- `image` - å›¾ç‰‡å¤„ç†
- `hound` - éŸ³é¢‘å¤„ç†
- `rustdct` - DCTç®—æ³•å®ç°
- `ffmpeg-sidecar` - è§†é¢‘å¤„ç†
- `ndarray` - æ•°ç»„è¿ç®—
- `colored` - å½©è‰²è¾“å‡º
- `indicatif` - è¿›åº¦æ¡æ˜¾ç¤º

## TODO

- [ ] æ”¯æŒæ›´å¤šéŸ³é¢‘æ ¼å¼ï¼ˆMP3ã€FLACç­‰ï¼‰
- [ ] æ·»åŠ DWTï¼ˆç¦»æ•£å°æ³¢å˜æ¢ï¼‰ç®—æ³•
- [ ] GUIç•Œé¢
- [ ] æ°´å°å¼ºåº¦è‡ªåŠ¨ä¼˜åŒ–
- [ ] æ‰¹é‡å¤„ç†åŠŸèƒ½
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
